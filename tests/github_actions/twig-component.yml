# {{ $ids := "twig-component" }}ids: {{ print $ids }}
# {{ $org := "oxid-esales" }}organisation: {{ print $org }}
# {{ $name := "twig-component" }}name: {{ print $name }}
prepare_shop:
  git:
    shop_ref: &git_shop_ref '{{ .Data.global.git.default_ref }}'
  composer:
    transform: |
      {
          "require": {
            "oxid-esales/twig-admin-theme": "dev-b-7.0-tmp-workflow"
          }
      }

install_module:
  matrix:
    testplan: '["-"]'
  cache:
    prefix: &install_module_prefix 'moduleInstallation-ce-{{ .Github.SHA }}-{{ .Github.RunID }}-{{ .Github.RunAttempt }}'
  ids: &ids '{{ print $ids }}'
  git:
    module:
      url: &git_module_url '{{ .Github.Repository }}'
      ref: '{{ .Github.RefName }}'
  package_name: &package_name '{{ print $org }}/{{ print $name }}'
  path: *ids

phpunit:
  matrix:
    testplan: '["tests/github_actions/defaults/module_phpunit_unit.yml","tests/github_actions/defaults/module_phpunit_integration.yml"]'
  load_shop: *install_module_prefix
  custom_script: |
    find .

codeception:
  matrix:
    testplan: 'skip'
  load_shop: *install_module_prefix

runtest:
  matrix:
    testplan: 'skip'
  load_shop: *install_module_prefix

sonarcloud:
  matrix:
    testplan: '["-"]'

styles:
  matrix:
    testplan: 'skip'
  load_shop: *install_module_prefix

finish:
  slack_title: 'Module {{ print $name }} ({{ .Data.global.git.shop_ref }}) on {{ .Github.Repository }} by {{ .Github.Actor }}'